FROM python:3.10.9-bullseye

WORKDIR /usr/src/app

COPY pyproject.toml ./
COPY main.py ./
COPY server/init_db.py ./

RUN pip install poetry && \
    poetry config virtualenvs.in-project true && \
    poetry install --no-root

EXPOSE 5000

CMD poetry run server && \
    python init_db.py