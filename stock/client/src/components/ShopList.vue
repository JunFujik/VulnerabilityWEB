<template>
  <div class="columns">
    <div class="column is-one-quarter" v-for="shop in props.shops" :key="shop.id">
      <div class="card" @click="onClick(shop)">
        <div class="card-image">
          <figure class="image is-96x96">
            <img v-if="props.shopImages[shop.id]" :src="props.shopImages[shop.id]"
              @error="props.shopImages[shop.id] = ''">
            <o-icon v-else icon="image" size="large" style="width:100%; height:100%"></o-icon>
          </figure>
        </div>
        <div class="card-content">
          <div class="media">
            <div class="media-left">
              <figure class="image is-48x48">
                <img v-if="shopImages[item.shop_id]" :src="shopImages[item.shop_id]"
                  @error="shopImages[item.shop_id] = ''">
                <o-icon v-else icon="image" size="large" style="width:100%; height:100%"></o-icon>
              </figure>
            </div>
            <div class="media-content">
              <p class="title">{{ shop.name }}</p>
            </div>
          </div>
          <div class="content">
            {{ shop.description }}
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import ShopDialog from './dialog/ShopDialog.vue';
import { useProgrammatic } from '@oruga-ui/oruga-next'
import { ShopWithitems } from '../openapi';

const props = withDefaults(defineProps<{
    shops:ShopWithitems[],
    shopImages:{[key:string]:string},
    editable?:boolean
}>(), {
  editable:false
})

const { oruga } = useProgrammatic()

const onClick=async (shop:ShopWithitems) => {
  oruga.modal.open({
    component: ShopDialog,
    props: {
      shop:shop,
      editable:props.editable
    },
    trapFocus: true,
  })
}
</script>