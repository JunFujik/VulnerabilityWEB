<template>
  <div class="modal-card">
    <header class="modal-card-head">
      <p class="modal-card-title">店舗詳細</p>
    </header>
    <section class="modal-card-body">
      <ShopEditor ref="edit" :shop="props.shop" v-if="props.editable"></ShopEditor>
      <ShopViewer :shop="props.shop" v-else></ShopViewer>
    </section>
    <footer class="modal-card-foot" v-if="props.editable" >
      <o-button class="button is-success" @click="onClick()">登録</o-button>
      <o-button v-if="props.shop" class="button is-danger is-right" @click="onDelete()">削除</o-button>
    </footer>
  </div>
</template>
<script setup lang="ts">
import { defineProps, ref } from 'vue';
import { ShopWithitems } from "../../openapi";
import ShopViewer from "./ShopViewer.vue";
import ShopEditor from "./ShopEditor.vue";

const edit=ref<InstanceType<typeof ShopEditor>>();

const props = withDefaults(defineProps<{
  shop?:ShopWithitems,
  editable?:boolean
}>(), {
  editable:false
});
const emit = defineEmits<{(e: 'close', v:{'action':String, 'method':String}):void}>()
const onClick = async () => {
  if(await edit.value?.onSubmit()){
    emit('close', {'action':'submit', 'method':'ok'})
  }
}

const onDelete = async () => {
  await edit.value?.onDelete()
  emit('close', {'action':'cancel', 'method':'cancel'})
}

</script>
<style scoped>

</style>