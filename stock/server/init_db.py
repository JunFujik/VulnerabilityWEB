from sqlalchemy import create_engine, MetaData, Table, Column, Integer, String
from sqlalchemy.orm import sessionmaker

from server.models import Base, Item, Shop

SQLALCHEMY_DATABASE_URL = "sqlite+aiosqlite://"

engine = create_engine(SQLALCHEMY_DATABASE_URL)

SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

def init_db():
    Base.metadata.create_all(bind=engine)

    db = SessionLocal()
    shop = Shop(name="My Shop", user_id=1)
    db.add(shop)
    db.commit()
    db.refresh(shop)

    item1 = Item(name="Item 1", price=10.99, shop_id=shop.id)
    item2 = Item(name="Item 2", price=5.99, shop_id=shop.id)

    db.add_all([item1, item2])
    db.commit()

init_db()
